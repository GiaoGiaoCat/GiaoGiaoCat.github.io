---
layout: post
title:  "Go 入门指南 - 基本结构和基本数据类型 - 1"
date:   2019-03-01 01:00:00

categories: go
tags: learningnote
author: "Victor"
---

## 文件名、关键字与标识符

* `_` 被称为空白标识符，任何赋给这个标识符的值都将被抛弃，不能在后续的代码中使用。
* 没有名称的变量、类型或方法，这些变量被统称为匿名变量。
* 变量取名的时候注意避开 25 个关键字或保留字和 36 个预定义标识符即可。
* 包名都应该使用小写字母。
* 除了符号 `_` 包中所有代码对象的标识符必须是唯一的，以避免名称冲突。但是相同的标识符可以在不同的包中使用，因为可以使用包名来区分它们。

## Go 程序的基本结构和要素

### 包的概念、导入与可见性

* 每个 Go 文件都属于且仅属于一个包，一个包可以由许多以 .go 为扩展名的源文件组成，因此文件名和包名一般来说都是不相同的。
* 必须在源文件中非注释的第一行指明这个文件属于哪个包，如：`package main`，其表示一个可独立执行的程序，每个 Go 应用程序都包含一个名为 main 的包。
* 编译包名不是为 main 的源文件，如 pack1，编译后产生的对象文件将会是 pack1.a 而不是可执行程序。
* Go 的标准库包含了大量的包，存放在 `$GOROOT/pkg/$GOOS_$GOARCH/` 目录下。
* 构建一个程序，则包和包内的文件都必须以正确的顺序进行编译。包的依赖关系决定了其构建顺序。
* 包既是编译时的一个单元，因此根据惯例，每个目录都只包含一个包。
* **对一个包进行更改或重新编译，所有引用了这个包的客户端程序都必须全部重新编译。**
* 导入多个包时，导入的顺序会按照字母排序。
* 包名不是以 `.` 或 `/` 开头，Go 会在全局文件进行查找；以 `./` 开头，Go 会在相对目录中查找。
* 导入包即等同于包含了这个包的所有的代码对象。
* 导入了一个包却没有使用它，则会在构建程序时引发错误。

#### 可见性规则

* 当标识符（包括常量、变量、类型、函数名、结构字段等等）以一个大写字母开头，就可以被外部包的代码所使用，这被称为 **导出**。
* 标识符如果以小写字母开头，则对包外是不可见的，但是他们在整个包的内部是可见并且可用的。
* 导入一个外部包后，能够且只能够访问该包中导出的对象。
* 通过使用包的别名来解决包名之间的名称冲突，或者说根据你的个人喜好对包名进行重新设置。

```go
package main

import fm "fmt" // alias

func main() {
   fm.Println("hello, world")
}
```

#### 包的分级声明和初始化

使用 `import` 导入包之后定义或声明 0 个或多个常量 const、变量 var 和类型 type，这些对象的作用域都是全局的（在本包范围内），所以可以被本包中所有的函数调用，然后声明一个或多个函数 func。

### 函数

定义一个函数最简单的格式：`func functionName()`。

* 括号 `()` 中写入 0 个或多个函数的参数（使用逗号 , 分隔），每个参数的名称后面必须紧跟着该参数的类型。
* 函数体使用大括号 `{}` 括起来。
* 只有当某个函数需要被外部包调用的时候才使用大写字母开头，并遵循 Pascal 命名法；否则就遵循骆驼命名法，即第一个单词的首字母小写，其余单词的首字母大写。
* 当被调用函数的代码执行到结束符 `}` 或返回语句时就会返回，然后程序继续执行调用该函数之后的代码。

```go
func functionName(parameter_list) (return_value_list) {
  //...
}
```

* parameter_list 的形式为 (param1 type1, param2 type2, ...)
* return_value_list 的形式为 (ret1 type1, ret2 type2, ...)

#### main 函数

* `main` 函数是每一个可执行程序所必须包含的，一般来说都是在启动后第一个执行的函数（如果有 `init()` 函数则会先执行该函数）。
* 如果你的 main 包的源代码没有包含 `main` 函数，则会引发构建错误
* `main` 函数即没有参数，也没有返回类型

**程序正常退出的代码为 0 即 Program exited with code 0；如果程序因为异常而被终止，则会返回非零值，如：1。这个数值可以用来测试是否成功执行一个程序。**

### 注释

* 单行注释 `//`
* 多行注释也叫块注释，均已以 `/*` 开头，并以 `*/` 结尾，一般用于包的文档描述或注释成块的代码片段。
* 一个包可以分散在多个文件中，但是只需要在其中一个进行注释说明即可。
* 几乎所有全局作用域的类型、常量、变量、函数和被导出的对象都应该有一个合理的注释。

### 类型

* 类型定义了某个变量的值的集合与可对其进行操作的集合。
* 可以包含数据的变量（或常量）可以使用不同的数据类型或类型来保存数据。
* 使用 var 声明的变量的值会自动初始化为该类型的零值。
* 类型可以是：
  * 基本类型，如：`int、float、bool、string`
  * 结构化的（复合的），如：`struct、array、slice、map、channel`
  * 只描述类型的行为的，如：`interface`
* 结构化的类型没有真正的值，它使用 nil 作为默认值，Go 语言中不存在类型继承。
* 函数也可以是一个确定的类型，就是以函数作为返回类型。这种类型的声明要写在函数名和可选的参数列表之后：`func FunctionName (a typea, b typeb) typeFunc`
* 可以在函数体中的某处返回使用类型为 typeFunc 的变量 var：`return var`

#### 定义和使用类型

使用 type 关键字可以定义你自己的类型，可能想要定义一个结构体，也可以定义一个已经存在的类型的别名，例如 `type IZ int`。

**这里并不是真正意义上的别名，因为使用这种方法定义之后的类型可以拥有更多的特性，且在类型转换时必须显式转换。**

```go
var a IZ = 5 // int 是变量 a 的底层类型，这也使得它们之间存在相互转换的可能
```

如果你有多个类型需要定义，可以使用因式分解关键字的方式：

```go
type (
   IZ int
   FZ float64
   STR string
)
```

每个值都必须在经过编译后属于某个类型（编译器必须能够推断出所有值的类型），**因为 Go 语言是一种静态类型语言。**

#### 函数可以拥有多返回值

* 返回类型之间需要使用逗号分割，并使用小括号 () 将它们括起来：`func FunctionName (a typea, b typeb) (t1 type1, t2 type2)`
* 返回的形式：`return var1, var2`
* 一般用于判断某个函数是否执行成功（true/false）或与其它返回值一同返回错误消息

### Go 程序的一般结构

1. 在完成包的 import 之后，开始对常量、变量和类型的定义或声明。
2. 如果存在 init 函数的话，则对该函数进行定义（这是一个特殊的函数，每个含有该函数的包都会首先执行这个函数）。
3. 如果当前包是 main 包，则定义 main 函数。
4. 然后定义其余的函数，首先是类型的方法，接着是按照 main 函数中先后调用的顺序来定义相关函数，如果有很多函数，则可以按照字母顺序来进行排序。

```go
package main

import (
   "fmt"
)

const c = "C"

var v int = 5

type T struct{}

func init() { // initialization of package
}

func main() {
   var a int
   Func1()
   // ...
   fmt.Println(a)
}

func (t T) Method1() {
   //...
}

func Func1() { // exported function Func1
   //...
}
```

### 类型转换

```go
valueOfTypeB = typeB(valueOfTypeA)
```

* 所有的转换都必须显式说明，就像调用一个函数一样。
* 只能在定义正确的情况下转换成功，当从一个取值范围较大的转换到取值范围较小的类型时（例如将 int32 转换为 int16 或将 float32 转换为 int），会发生精度丢失。
* 编译器捕捉到非法的类型转换时会引发编译时错误，否则将引发运行时错误。
* 具有相同底层类型的变量之间可以相互转换。

```go
a := 5.0
b := int(a)

var a IZ = 5
c := int(a)
d := IZ(c)
```

### Go 命名规范

* 名称不需要指出自己所属的包，因为在调用的时候会使用包名作为限定符
* 返回某个对象的函数或方法的名称一般都是使用名词，没有 `Get...` 之类的字符
* 用于修改某个对象，则使用 `SetName`
* 有必须要的话可以使用大小写混合的方式，如 MixedCaps 或 mixedCaps，而不是使用下划线来分割多个名称

## 相关

* [Go 入门指南](https://www.kancloud.cn/kancloud/the-way-to-go/72456)
